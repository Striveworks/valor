For most of the colonial period, Dutch control over these territories was tenuous; only in the early 20th century did Dutch dominance extend to what was to become Indonesia's current boundaries. Dutch troops were constantly engaged in quelling rebellions both on and off Java. The influence of local leaders such as Prince Diponegoro in central Java, Imam Bonjol in central Sumatra and Pattimura in Maluku, and a bloody thirty-year war in Aceh weakened the Dutch and tied up the colonial military forces.(Schwartz 1999, pages 3â4) Despite major internal political, social and sectarian divisions during the National Revolution, Indonesians, on the whole, found unity in their fight for independence.  The Japanese invasion and subsequent occupation during WWII ended Dutch rule,  ;    and encouraged the previously suppressed Indonesian independence movement. Two days after the surrender of Japan in August 1945, Sukarno, an influential nationalist leader, declared independence and was appointed president.  ;  ;  ; Reid (1973), page 30  The Netherlands tried to reestablish their rule, and a bitter armed and diplomatic struggle ended in December 1949, when in the face of international pressure, the Dutch formally recognized Indonesian independence.  ;